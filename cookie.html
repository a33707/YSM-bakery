<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë”°ë‹˜ì„ ìœ„í•œ ì¿ í‚¤ ë§ˆìŠ¤í„°</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #fffaf0;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            overflow: hidden;
            touch-action: none;
        }

        /* í—¤ë” & ë ˆë²¨ ì‹œìŠ¤í…œ */
        header {
            width: 100%;
            padding: 15px;
            background: white;
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .level-badge {
            background: #ffc0cb;
            color: white; padding: 5px 15px; border-radius: 20px; font-weight: bold;
        }
        .exp-bar {
            width: 150px; height: 10px; background: #eee; border-radius: 5px; overflow: hidden;
        }
        #exp-fill {
            width: 0%; height: 100%; background: #ffc0cb; transition: width 0.5s;
        }

        /* ì¿ í‚¤ ì‘ì—…ëŒ€ */
        #cookie-base {
            width: 250px; height: 250px;
            background: #f3d5b5;
            border-radius: 50%;
            position: relative; box-shadow: 0 8px 0 #d2b48c;
            margin: 20px; cursor: pointer;
            overflow: hidden;
        }

        /* í† í•‘ ì„ íƒ ë°”: 16ì¢… ëŒ€ì‘ì„ ìœ„í•´ íŒ¨ë”© ë° ê°„ê²© ì¡°ì • */
        .topping-bar {
            display: flex; gap: 6px; flex-wrap: wrap; justify-content: center;
            padding: 12px; background: #fff; border-radius: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1); max-width: 95%;
        }
        .topping-item { 
            font-size: 28px; cursor: pointer; padding: 5px; 
            border: 3px solid transparent; border-radius: 12px;
            transition: 0.2s;
        }
        .topping-item.selected { border-color: #ffc0cb; background: #ffe4e1; transform: scale(1.1); }

        .placed-topping {
            position: absolute; font-size: 30px; pointer-events: none;
            transform: translate(-50%, -50%); animation: pop 0.3s ease-out;
            z-index: 2;
        }

        @keyframes pop {
            0% { transform: translate(-50%, -50%) scale(0); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        .placed-jam {
            position: absolute;
            width: 35px; height: 35px; border-radius: 50%;
            pointer-events: none; filter: blur(4px); opacity: 0.7;
            transform: translate(-50%, -50%); z-index: 1;
        }

        /* ìŠ¤í…Œì´ì§€ */
        .stage { display: none; flex-direction: column; align-items: center; width: 100%; }
        .stage.active { display: flex; }

        #stamp-card {
            padding: 20px; background: white; border: 3px solid #ffc0cb;
            border-radius: 15px; margin-top: 20px; display: none;
            text-align: center;
        }

        button {
            margin-top: 20px; padding: 12px 30px; font-size: 18px;
            border: none; border-radius: 25px; background: #ffc0cb;
            color: white; cursor: pointer; font-weight: bold;
        }
        
        .home-btn {
            background: #ccc; margin-left: 10px;
        }
    </style>
</head>
<body>

    <header>
        <div>
            <span id="rank-text">ğŸª ì¿ í‚¤ ì´ˆë³´</span>
            <div class="exp-bar"><div id="exp-fill"></div></div>
        </div>
        <div class="level-badge">LV.<span id="level-num">1</span></div>
    </header>

    <div id="stage1" class="stage active">
        <h2 style="color:#d66d87;">ë‚˜ë§Œì˜ ì¿ í‚¤ë¥¼ ë§Œë“¤ì–´ë´ìš”!</h2>
        <div id="cookie-base" onclick="placeTopping(event)"></div>
        
        <div class="topping-bar">
            <div class="topping-item selected" onclick="selectTopping(this, 'ğŸ«', 'emoji')">ğŸ«</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸ¬', 'emoji')">ğŸ¬</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸ’–', 'emoji')">ğŸ’–</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸŒˆ', 'emoji')">ğŸŒˆ</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸŒŸ', 'emoji')">ğŸŒŸ</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸ¥¨', 'emoji')">ğŸ¥¨</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸ¥œ', 'emoji')">ğŸ¥œ</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸ’', 'emoji')">ğŸ’</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸª', 'emoji')">ğŸª</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸ¥›', 'emoji')">ğŸ¥›</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸ¨', 'emoji')">ğŸ¨</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸ', 'emoji')">ğŸ</div>
            <div class="topping-item" onclick="selectTopping(this, '#ff0000', 'jam')" title="ë”¸ê¸°ì¼">ğŸ’‰ğŸ“</div>
            <div class="topping-item" onclick="selectTopping(this, '#ffd700', 'jam')" title="ê¿€">ğŸ’‰ğŸ¯</div>
            <div class="topping-item" onclick="selectTopping(this, '#4682b4', 'jam')" title="ë¸”ë£¨ë² ë¦¬ì¼">ğŸ’‰ğŸ«</div>
            <div class="topping-item" onclick="selectTopping(this, '#ffffff', 'jam')" title="í™”ì´íŠ¸ì´ˆì½”">ğŸ’‰ğŸ¤</div>
        </div>
        
        <div style="display:flex;">
            <button onclick="bakeAndDeliver()">ì˜¤ë¸ì— êµ½ê¸° & ë°°ë‹¬! ğŸ”¥</button>
            <button onclick="location.href='index.html'" class="home-btn">ğŸ  í™ˆìœ¼ë¡œ</button>
        </div>
    </div>

    <div id="stage2" class="stage">
        <h2 id="delivery-status">ì¿ í‚¤ê°€ ì†ë‹˜ì—ê²Œ ê°€ëŠ” ì¤‘...</h2>
        <div id="scooter-track" style="font-size: 40px; width: 80%; text-align: left; margin-top: 50px;">
            <span id="scooter" style="position:relative; left:0; transition:3s linear;">ğŸ›µğŸ“¦</span>
            <span style="float:right;">ğŸ¡</span>
        </div>
        
        <div id="stamp-card">
            <h3>ğŸ‰ ë°°ë‹¬ ì„±ê³µ!</h3>
            <p>ì†ë‹˜ì´ ë„ˆë¬´ í–‰ë³µí•´í•´ìš”!</p>
            <div style="font-size: 60px;">ğŸ’¯</div>
        </div>
        
        <button id="next-btn" onclick="nextCookie()">ë‹¤ìŒ ì¿ í‚¤ ë§Œë“¤ê¸°</button>
    </div>

    <script>
        let selectedTopping = 'ğŸ«';
        let selectedType = 'emoji';
        let exp = 0;
        let level = 1;
        const ranks = ["ğŸª ì¿ í‚¤ ì´ˆë³´", "ğŸ© ì¿ í‚¤ ê²¬ìŠµ", "ğŸ‘¨â€ğŸ³ ì¿ í‚¤ ì „ë¬¸", "ğŸ‘‘ ì¿ í‚¤ ë§ˆìŠ¤í„°"];

        function selectTopping(el, val, type) {
            document.querySelectorAll('.topping-item').forEach(i => i.classList.remove('selected'));
            el.classList.add('selected');
            selectedTopping = val;
            selectedType = type;
        }

        function placeTopping(e) {
            const cookie = document.getElementById('cookie-base');
            const rect = cookie.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            const item = document.createElement('div');
            if (selectedType === 'emoji') {
                item.className = 'placed-topping';
                item.innerText = selectedTopping;
            } else {
                item.style.position = 'absolute';
                item.style.width = '35px'; item.style.height = '35px';
                item.style.backgroundColor = selectedTopping;
                item.style.borderRadius = '50%'; item.style.filter = 'blur(4px)';
                item.style.opacity = '0.7'; item.style.zIndex = '1';
                item.style.transform = 'translate(-50%, -50%)';
            }
            item.style.left = x + 'px';
            item.style.top = y + 'px';
            cookie.appendChild(item);
            
            updateExp(2);
        }

        function updateExp(amount) {
            exp += amount;
            if (exp >= 100) {
                exp = 0;
                level++;
                document.getElementById('level-num').innerText = level;
                const rankIdx = Math.min(Math.floor(level / 2), ranks.length - 1);
                document.getElementById('rank-text').innerText = ranks[rankIdx];
                alert("ì™€ì•„! ë ˆë²¨ì—…! " + ranks[rankIdx] + "ê°€ ë˜ì—ˆì–´ìš”! ğŸ‰");
            }
            document.getElementById('exp-fill').style.width = exp + "%";
        }

        function bakeAndDeliver() {
            document.getElementById('cookie-base').style.backgroundColor = '#c68642';
            alert("ğŸ”¥ ì¿ í‚¤ê°€ ë…¸ë¦‡ë…¸ë¦‡ êµ¬ì›Œì¡Œì–´ìš”! ì´ì œ ë°°ë‹¬ ê°ˆê¹Œìš”?");

            document.getElementById('stage1').classList.remove('active');
            document.getElementById('stage2').classList.add('active');
            
            const scooter = document.getElementById('scooter');
            setTimeout(() => { scooter.style.left = "calc(100% - 60px)"; }, 100);

            setTimeout(() => {
                document.getElementById('delivery-status').innerText = "âœ… ë°°ë‹¬ ì™„ë£Œ!";
                document.getElementById('stamp-card').style.display = 'block';
                document.getElementById('next-btn').style.display = 'block';
                updateExp(30);
            }, 3200);
        }

        function nextCookie() {
            document.getElementById('cookie-base').innerHTML = '';
            document.getElementById('cookie-base').style.backgroundColor = '#f3d5b5';
            document.getElementById('stamp-card').style.display = 'none';
            document.getElementById('next-btn').style.display = 'none';
            document.getElementById('scooter').style.left = "0";
            document.getElementById('delivery-status').innerText = "ì¿ í‚¤ê°€ ì†ë‹˜ì—ê²Œ ê°€ëŠ” ì¤‘...";
            document.getElementById('stage2').classList.remove('active');
            document.getElementById('stage1').classList.add('active');
        }
    </script>
</body>
</html>