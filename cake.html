<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë”°ë‹˜ì„ ìœ„í•œ ì¼€ì´í¬ ë§ˆìŠ¤í„°</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #fff0f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            overflow: hidden;
            touch-action: none;
        }

        /* í—¤ë” & ë ˆë²¨ ì‹œìŠ¤í…œ */
        header {
            width: 100%;
            padding: 15px;
            background: white;
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .level-badge {
            background: #ff69b4; color: white;
            padding: 5px 15px; border-radius: 20px; font-weight: bold;
        }
        .exp-bar {
            width: 150px; height: 10px; background: #eee;
            border-radius: 5px; overflow: hidden;
        }
        #exp-fill {
            width: 0%; height: 100%; background: #ff69b4;
            transition: width 0.5s;
        }

        /* ì¼€ì´í¬ ì‘ì—…ëŒ€ */
        #cake-base {
            width: 280px; height: 200px;
            background: #ffffff; border-radius: 30px;
            position: relative; box-shadow: 0 15px 0 #f0f0f0;
            margin: 30px; cursor: pointer;
            overflow: hidden;
        }

        .topping-item { 
            font-size: 32px; cursor: pointer; padding: 6px;
            border: 3px solid transparent; border-radius: 15px;
            transition: 0.2s;
        }
        .topping-item.selected { border-color: #ff69b4; background: #ffe4e1; transform: scale(1.1); }

        .placed-topping {
            position: absolute; font-size: 35px; pointer-events: none;
            transform: translate(-50%, -50%); animation: pop 0.3s ease-out;
            z-index: 2;
        }

        @keyframes pop {
            0% { transform: translate(-50%, -50%) scale(0); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        /* ìŠ¤í…Œì´ì§€ */
        .stage { display: none; flex-direction: column; align-items: center; width: 100%; }
        .stage.active { display: flex; }

        /* ê²°ê³¼ í™”ë©´ (ìŠ¤íƒ¬í”„) */
        #stamp-card {
            padding: 20px; background: white; border: 3px solid #ff69b4;
            border-radius: 15px; margin-top: 20px; display: none;
        }

        button {
            margin-top: 20px; padding: 15px 40px; font-size: 20px;
            border: none; border-radius: 30px; background: #ff69b4;
            color: white; cursor: pointer; font-weight: bold;
        }
        
        /* í™ˆ ë²„íŠ¼ ì¶”ê°€ */
        .home-btn {
            position: absolute; top: 15px; left: 15px;
            background: #999; padding: 8px 15px; font-size: 14px;
        }
    </style>
</head>
<body>

    <header>
        <div>
            <span id="rank-text">ğŸ£ ì´ˆë³´ ìš”ë¦¬ì‚¬</span>
            <div class="exp-bar"><div id="exp-fill"></div></div>
        </div>
        <div class="level-badge">LV.<span id="level-num">1</span></div>
    </header>

    <div id="stage1" class="stage active">
        <h2 style="color:#d66d87;">ì¼€ì´í¬ë¥¼ ë©‹ì§€ê²Œ ê¾¸ë©°ë´ìš”!</h2>
        <div id="cake-base" onclick="placeTopping(event)"></div>
        <div style="display:flex; gap:8px; flex-wrap:wrap; justify-content:center; padding:10px; max-width: 90%;">
            <div class="topping-item selected" onclick="selectTopping(this, 'ğŸ“', 'emoji')">ğŸ“</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸ«', 'emoji')">ğŸ«</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸ«', 'emoji')">ğŸ«</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸŠ', 'emoji')">ğŸŠ</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸ¬', 'emoji')">ğŸ¬</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸ’–', 'emoji')">ğŸ’–</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸŒŸ', 'emoji')">ğŸŒŸ</div>
            <div class="topping-item" onclick="selectTopping(this, 'ğŸ•¯ï¸', 'emoji')">ğŸ•¯ï¸</div>
            <div class="topping-item" onclick="selectTopping(this, '#ff69b4', 'jam')" title="í•‘í¬ ì¼">ğŸ’‰ğŸ’–</div>
            <div class="topping-item" onclick="selectTopping(this, '#ffd700', 'jam')" title="ê¿€">ğŸ’‰ğŸ¯</div>
            <div class="topping-item" onclick="selectTopping(this, '#4b0082', 'jam')" title="í¬ë„ ì¼">ğŸ’‰ğŸ‡</div>
            <div class="topping-item" onclick="selectTopping(this, '#00fa9a', 'jam')" title="ë¯¼íŠ¸ ì‹œëŸ½">ğŸ’‰ğŸƒ</div>
        </div>
        <div style="display:flex; gap:10px;">
            <button onclick="goStage2()">ë°°ë‹¬ ì‹œì‘! ğŸ›µ</button>
            <button onclick="location.href='index.html'" class="home-btn" style="position:static;">ğŸ  ì²˜ìŒìœ¼ë¡œ</button>
        </div>
    </div>

    <div id="stage2" class="stage">
        <h2 id="delivery-status">ğŸ›µ ì†ë‹˜ì—ê²Œ ê°€ëŠ” ì¤‘...</h2>
        <div id="scooter-track" style="font-size: 50px; width: 80%; text-align: left; margin-top: 50px;">
            <span id="scooter" style="position:relative; left:0; transition:3s linear;">ğŸ›µğŸ“¦</span>
            <span style="float:right;">ğŸ </span>
        </div>
        
        <div id="stamp-card">
            <h3>ğŸ‰ ë°°ë‹¬ ì„±ê³µ!</h3>
            <p>ì†ë‹˜ì´ ë„ˆë¬´ ê¸°ë»í•´ìš”!</p>
            <div style="font-size: 60px;">ğŸ’®</div>
        </div>
        
        <button id="next-btn" onclick="nextLevel()" style="display:none;">ë‹¤ìŒ ì¼€ì´í¬ ë§Œë“¤ê¸°</button>
    </div>

    <script>
        let selectedTopping = 'ğŸ“';
        let selectedType = 'emoji';
        let exp = 0;
        let level = 1;
        const ranks = ["ğŸ£ ì´ˆë³´ ìš”ë¦¬ì‚¬", "ğŸ¥ ê²¬ìŠµ ì…°í”„", "ğŸ‘¨â€ğŸ³ ì „ë¬¸ ìš”ë¦¬ì‚¬", "ğŸ‘‘ ì¼€ì´í¬ ë§ˆìŠ¤í„°"];

        function selectTopping(el, val, type) {
            document.querySelectorAll('.topping-item').forEach(i => i.classList.remove('selected'));
            el.classList.add('selected');
            selectedTopping = val;
            selectedType = type;
        }

        function placeTopping(e) {
            const cake = document.getElementById('cake-base');
            const rect = cake.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            const item = document.createElement('div');
            if (selectedType === 'emoji') {
                item.className = 'placed-topping';
                item.innerText = selectedTopping;
            } else {
                item.style.position = 'absolute';
                item.style.width = '40px'; item.style.height = '40px';
                item.style.backgroundColor = selectedTopping;
                item.style.borderRadius = '50%'; item.style.filter = 'blur(5px)';
                item.style.opacity = '0.7'; item.style.zIndex = '1';
                item.style.transform = 'translate(-50%, -50%)';
            }
            item.style.left = x + 'px';
            item.style.top = y + 'px';
            cake.appendChild(item);
            
            updateExp(2);
        }

        function updateExp(amount) {
            exp += amount;
            if (exp >= 100) {
                exp = 0;
                level++;
                document.getElementById('level-num').innerText = level;
                const rankIdx = Math.min(Math.floor(level / 2), ranks.length - 1);
                document.getElementById('rank-text').innerText = ranks[rankIdx];
                alert("ì™€ì•„! ë ˆë²¨ì—…! " + ranks[rankIdx] + "ê°€ ë˜ì—ˆì–´ìš”! ğŸ‰");
            }
            document.getElementById('exp-fill').style.width = exp + "%";
        }

        function goStage2() {
            document.getElementById('stage1').classList.remove('active');
            document.getElementById('stage2').classList.add('active');
            
            const scooter = document.getElementById('scooter');
            setTimeout(() => { scooter.style.left = "calc(100% - 60px)"; }, 100);

            setTimeout(() => {
                document.getElementById('delivery-status').innerText = "âœ… ë°°ë‹¬ ì™„ë£Œ!";
                document.getElementById('stamp-card').style.display = 'block';
                document.getElementById('next-btn').style.display = 'block';
                updateExp(30);
            }, 3200);
        }

        function nextLevel() {
            document.getElementById('cake-base').innerHTML = '';
            document.getElementById('stamp-card').style.display = 'none';
            document.getElementById('next-btn').style.display = 'none';
            document.getElementById('scooter').style.left = "0";
            document.getElementById('delivery-status').innerText = "ğŸ›µ ì†ë‹˜ì—ê²Œ ê°€ëŠ” ì¤‘...";
            document.getElementById('stage2').classList.remove('active');
            document.getElementById('stage1').classList.add('active');
        }
    </script>
</body>
</html>