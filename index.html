<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë”°ë‹˜ì„ ìœ„í•œ ì¼€ì´í¬ ë°°ë‹¬ ë³¸ë¶€</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #fff0f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            overflow: hidden;
            touch-action: none;
        }

        h1 { color: #ff69b4; margin-top: 15px; }

        /* ìŠ¤í…Œì´ì§€ ê´€ë¦¬ */
        .stage { display: none; flex-direction: column; align-items: center; width: 100%; }
        .stage.active { display: flex; }

        /* 1ë‹¨ê³„: ì¼€ì´í¬ ê¾¸ë¯¸ê¸° */
        #cake-base {
            width: 250px;
            height: 180px;
            background: #fff; /* ìƒí¬ë¦¼ */
            border-radius: 20px;
            position: relative;
            box-shadow: 0 10px 0 #eee, 0 20px 0 #ddd;
            margin: 40px;
        }

        .topping-bar {
            display: flex; gap: 15px; padding: 15px;
            background: white; border-radius: 30px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .topping-item { font-size: 40px; cursor: grab; }

        .placed-topping {
            position: absolute; font-size: 35px; pointer-events: none;
            transform: translate(-50%, -50%);
        }

        /* 2ë‹¨ê³„: í¬ì¥í•˜ê¸° */
        #box-container {
            width: 300px;
            height: 250px;
            border: 5px dashed #ffb6c1;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            background: white;
        }

        .ribbon {
            position: absolute; width: 100%; height: 20px;
            background: #ff1493; display: none;
        }

        /* 3ë‹¨ê³„: ë°°ë‹¬í•˜ê¸° (ì• ë‹ˆë©”ì´ì…˜) */
        #delivery-scene {
            font-size: 80px;
            position: relative;
            width: 100%;
            height: 200px;
        }
        #scooter {
            position: absolute; left: -100px;
            transition: left 3s linear;
        }

        /* ê³µí†µ ë²„íŠ¼ */
        button {
            margin-top: 20px; padding: 15px 40px; font-size: 20px;
            border: none; border-radius: 30px; background: #ff69b4;
            color: white; cursor: pointer; font-weight: bold;
        }
    </style>
</head>
<body>

    <h1 id="status-text">ğŸ‚ ì¼€ì´í¬ë¥¼ ê¾¸ë©°ìš”!</h1>

    <div id="stage1" class="stage active">
        <div id="cake-base"></div>
        <div class="topping-bar">
            <div class="topping-item" draggable="true" ondragstart="drag(event)">ğŸ“</div>
            <div class="topping-item" draggable="true" ondragstart="drag(event)">ğŸ«</div>
            <div class="topping-item" draggable="true" ondragstart="drag(event)">ğŸ•¯ï¸</div>
            <div class="topping-item" draggable="true" ondragstart="drag(event)">ğŸ’–</div>
        </div>
        <button onclick="goStage2()">í¬ì¥í•˜ê¸° ğŸ‘‰</button>
    </div>

    <div id="stage2" class="stage">
        <div id="box-container">
            <div id="final-cake-preview"></div>
            <div id="ribbon-horizontal" class="ribbon" style="top: 50%;"></div>
            <div id="ribbon-vertical" class="ribbon" style="width: 20px; height: 100%; left: 50%; top: 0;"></div>
        </div>
        <button onclick="packBox()">ë¦¬ë³¸ ë¬¶ê¸° ğŸ€</button>
        <button id="delivery-btn" onclick="goStage3()" style="display:none; background: #4caf50;">ë°°ë‹¬ ì¶œë°œ! ğŸ›µ</button>
    </div>

    <div id="stage3" class="stage">
        <div id="delivery-scene">
            <div id="scooter">ğŸ›µ ğŸ“¦</div>
        </div>
        <div style="font-size: 50px; margin-top: 20px;">ğŸ </div>
        <button onclick="resetGame()">ìƒˆë¡œ ë§Œë“¤ê¸°</button>
    </div>

    <script>
        const cake = document.getElementById('cake-base');
        let cakeHTML = "";

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­
        cake.ondragover = (e) => e.preventDefault();
        cake.ondrop = (e) => {
            const emoji = e.dataTransfer.getData("text");
            const rect = cake.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            const topping = document.createElement('div');
            topping.className = 'placed-topping';
            topping.innerText = emoji;
            topping.style.left = x + 'px';
            topping.style.top = y + 'px';
            cake.appendChild(topping);
        };

        function drag(e) { e.dataTransfer.setData("text", e.target.innerText); }

        // ë‹¨ê³„ ì´ë™: í¬ì¥
        function goStage2() {
            cakeHTML = cake.innerHTML;
            document.getElementById('status-text').innerText = "ğŸ ì˜ˆì˜ê²Œ í¬ì¥í•´ìš”!";
            document.getElementById('stage1').classList.remove('active');
            document.getElementById('stage2').classList.add('active');
            
            // ì™„ì„±ëœ ì¼€ì´í¬ ë³µì‚¬í•´ì„œ ë³´ì—¬ì£¼ê¸°
            const preview = document.getElementById('final-cake-preview');
            preview.innerHTML = `<div id="cake-base" style="transform: scale(0.7); margin:0;">${cakeHTML}</div>`;
        }

        function packBox() {
            document.querySelectorAll('.ribbon').forEach(r => r.style.display = 'block');
            document.getElementById('delivery-btn').style.display = 'inline-block';
            alert("í¬ì¥ ì™„ë£Œ! ì´ì œ ë°°ë‹¬ì„ ê°ˆ ìˆ˜ ìˆì–´ìš”.");
        }

        // ë‹¨ê³„ ì´ë™: ë°°ë‹¬
        function goStage3() {
            document.getElementById('status-text').innerText = "ğŸ›µ ìŠìŠ~ ë°°ë‹¬ ì¤‘!";
            document.getElementById('stage2').classList.remove('active');
            document.getElementById('stage3').classList.add('active');
            
            const scooter = document.getElementById('scooter');
            setTimeout(() => {
                scooter.style.left = "calc(100% - 100px)";
            }, 100);

            setTimeout(() => {
                alert("ë”©ë™! ì§‘ ì•ì— ì¼€ì´í¬ê°€ ë„ì°©í–ˆìŠµë‹ˆë‹¤! ğŸ‚");
                document.getElementById('status-text').innerText = "âœ… ë°°ë‹¬ ì™„ë£Œ!";
            }, 3200);
        }

        function resetGame() {
            location.reload();
        }
    </script>
</body>
</html>